[build]
    publish = "public"
    command = "npm run build"

[context.deploy-preview]
    command = "npm run build -- -b $DEPLOY_PRIME_URL"

[context.branch-deploy]
    command = "npm run build -- -b $DEPLOY_PRIME_URL"

[context.next]
    command = "npm run build"

[context.next.environment]
    HUGO_ENV = "next"

[dev]
    framework = "#custom"
    command = "npm run start"
    targetPort = 1313
    port = 8888
    publish = "public"
    autoLaunch = false

[[plugins]]
    package = "@gethinode/netlify-plugin-dartsass"

[[plugins]]
    package = "netlify-plugin-hugo-cache-resources"

[[headers]]
  for = "/admin/*"

  [headers.values]
    Content-Security-Policy = """
      base-uri 'self'; \
      default-src 'none'; \
      script-src 'self' *.netlify.com unpkg.com 'unsafe-inline' 'unsafe-eval'; \
      connect-src 'self' *.netlify.com; \
      frame-src identity.netlify.com; \
      style-src 'self' 'unsafe-inline'; \
      img-src 'self' data:; \
      font-src 'self' data:; \
      object-src 'none'; \
      """

